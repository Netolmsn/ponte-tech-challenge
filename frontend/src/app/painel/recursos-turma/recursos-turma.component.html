<div class="container">
  @if (turma$ | async; as turma) {
    <nav class="breadcrumb">
      <a routerLink="/painel">Minhas Turmas</a>
      <mat-icon>chevron_right</mat-icon>
      <span>{{ turma.treinamento?.nome }} / {{ turma.nome }}</span>
    </nav>
  }

  <mat-card class="mat-elevation-z8">
    <mat-card-header>
      <mat-card-title>Recursos da Turma</mat-card-title>
    </mat-card-header>

    @if (recursos$ | async; as recursos) {
      @if (recursos.length > 0) {
        <mat-list>
          @for (recurso of recursos; track recurso.id) {
            <mat-list-item class="recurso-item">
              <mat-icon matListItemIcon>
                @switch (recurso.tipo) {
                  @case ('video') { movie }
                  @case ('pdf') { picture_as_pdf }
                  @case ('zip') { archive }
                  @default { description }
                }
              </mat-icon>
              <div matListItemTitle>{{ recurso.nome }}</div>
              <div matListItemLine>{{ recurso.descricao }}</div>

              @if (recurso.tipo === 'video') {
                <div class="video-player">
                  <video controls [src]="getVideoUrl(recurso)" width="100%">
                    Seu navegador não suporta o player de vídeo.
                  </video>
                </div>
              }

              <div matListItemMeta>
                <button mat-icon-button color="primary" (click)="downloadRecurso(recurso)">
                  <mat-icon>download</mat-icon>
                </button>
              </div>
            </mat-list-item>
          }
        </mat-list>
      } @else {
        <div class="empty-state">
          <span>Nenhum recurso disponível para esta turma.</span>
        </div>
      }
    } @else {
      <div class="loading-spinner">
        <mat-spinner></mat-spinner>
      </div>
    }
  </mat-card>
</div>