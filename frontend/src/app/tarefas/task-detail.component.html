<div class="tarefas-detail-root">
  <div class="tarefas-detail-header flex items-center justify-between mb-3">
    <button
      type="button"
      class="tarefas-detail-back-btn inline-flex items-center gap-1 text-xs text-slate-600 hover:text-indigo-500"
      (click)="voltar()"
    >
      <span class="material-icons text-base">arrow_back</span>
      <span>Voltar para minhas tarefas</span>
    </button>
  </div>

  <div
    *ngIf="!loading && tarefa; else loadingOrError"
    class="tarefas-detail-card bg-white rounded-2xl shadow-sm p-6"
  >
    <h1 class="tarefas-detail-title text-lg font-semibold text-slate-800 mb-1">
      {{ tarefa.titulo }}
    </h1>
    <p class="tarefas-detail-subtitle text-xs text-slate-500 mb-4">
      Status: {{ tarefa.status }} | Prioridade: {{ tarefa.prioridade }}
    </p>

    <div class="tarefas-detail-body space-y-2 text-sm text-slate-700 mb-4">
      <p>{{ tarefa.descricao }}</p>
      <p class="text-xs text-slate-500">
        Criação: {{ tarefa.criado_em | date: 'short' }}
      </p>
      <p class="text-xs text-slate-500">
        Atualização: {{ tarefa.atualizado_em | date: 'short' }}
      </p>
    </div>

    <h3 class="text-xs font-semibold text-slate-500 mb-2">Atualizar status</h3>
    <div class="tarefas-detail-status-actions flex flex-wrap gap-2 mb-4">
      <button
        type="button"
        [disabled]="updating"
        (click)="atualizarStatus('PENDENTE')"
        class="rounded-full border border-slate-300 px-4 py-1 text-xs text-slate-700 hover:bg-slate-50 disabled:opacity-60 disabled:cursor-not-allowed"
      >
        Pendente
      </button>
      <button
        type="button"
        [disabled]="updating"
        (click)="atualizarStatus('EM_ANDAMENTO')"
        class="rounded-full border border-slate-300 px-4 py-1 text-xs text-slate-700 hover:bg-slate-50 disabled:opacity-60 disabled:cursor-not-allowed"
      >
        Em progresso
      </button>
      <button
        type="button"
        [disabled]="updating"
        (click)="atualizarStatus('CONCLUIDA')"
        class="rounded-full border border-indigo-500 bg-indigo-500 px-4 py-1 text-xs font-medium text-white hover:bg-indigo-600 disabled:opacity-60 disabled:cursor-not-allowed"
      >
        Concluída
      </button>
    </div>

    <div class="tarefas-detail-footer flex justify-end">
      <button
        type="button"
        (click)="excluir()"
        class="inline-flex items-center gap-1 rounded-full border border-red-200 px-4 py-1 text-xs font-medium text-red-600 hover:bg-red-50"
      >
        <span class="material-icons text-sm">delete</span>
        <span>Excluir</span>
      </button>
    </div>
  </div>

  <ng-template #loadingOrError>
    <div class="tarefas-detail-card bg-white rounded-2xl shadow-sm p-6">
      <div *ngIf="loading" class="text-sm text-slate-500">
        Carregando tarefa...
      </div>
      <div *ngIf="!loading && error" class="text-sm text-red-500">
        {{ error }}
      </div>
    </div>
  </ng-template>
</div>
